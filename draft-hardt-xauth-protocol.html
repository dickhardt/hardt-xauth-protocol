<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta name="scripts" content="Common,Latin">
<title>The XAuth Protocol</title>
<meta name="author" content="Dick Hardt">
<meta name="description" content="
       Client software often desires resources or identity claims that are managed independent of the client. This protocol allows a user and/or resource owner to delegate resource authorization and/or release of identity claims to an authorization server. Client software can then request access to resources and/or identity claims by calling the authorization server. The authorization server acquires consent and authorization from the user and/or resource owner if required, and then returns the authorization and identity claims that were approved. This protocol can be extended to support alternative client authentication mechanisms, authorizations, claims, and interactions. 
       [Editor: suggestions on how to improve this are welcome!] 
       [Editor: suggestions for other names than XAuth are welcome!] 
    ">
<meta name="generator" content="xml2rfc 2.16.3">
<link rel="alternate" type="application/rfc+xml" href="draft-hardt-xauth-protocol.xml">
<link rel="license" href="#copyright">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 624px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  line-height: 17px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  font-style: italic;
  margin: 0.3em 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 600px) {
  #authors-addresses {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 953px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 954px) {
  body {
    padding-right: 380px;
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link rel="stylesheet" href="rfc-local.css" type="text/css">
</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The XAuth Protocol</td>
<td class="right">January 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt</td>
<td class="center">Expires 1 August 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information">
<dl id="identifiers">
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hardt-xauth-protocol-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-01-29" class="published">29 January 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-08-01">1 August 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt, <span class="editor">Ed.</span>
</div>
<div class="org">SignIn.Org</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The XAuth Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Client software often desires resources or identity claims that are managed independent of the client. This protocol allows a user and/or resource owner to delegate resource authorization and/or release of identity claims to an authorization server. Client software can then request access to resources and/or identity claims by calling the authorization server. The authorization server acquires consent and authorization from the user and/or resource owner if required, and then returns the authorization and identity claims that were approved. This protocol can be extended to support alternative client authentication mechanisms, authorizations, claims, and interactions.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">[Editor: suggestions on how to improve this are welcome!]<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">[Editor: suggestions for other names than XAuth are welcome!]<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/dickhardt/hardt-xauth-protocol">https://github.com/dickhardt/hardt-xauth-protocol</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.
        <a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.
        <a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."
        <a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 August 2020.
        <a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.
        <a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.
        <a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-boilerplate.3">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.1">
            <p id="section-boilerplate.3-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-boilerplate.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.2">
            <p id="section-boilerplate.3-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-protocol" class="xref">Protocol</a><a href="#section-boilerplate.3-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.2.2.1">
                <p id="section-boilerplate.3-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-parties" class="xref">Parties</a><a href="#section-boilerplate.3-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.2.2.2">
                <p id="section-boilerplate.3-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-handles" class="xref">Handles</a><a href="#section-boilerplate.3-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.2.2.3">
                <p id="section-boilerplate.3-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-reused-terms" class="xref">Reused Terms</a><a href="#section-boilerplate.3-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.2.2.4">
                <p id="section-boilerplate.3-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-sequence" class="xref">Sequence</a><a href="#section-boilerplate.3-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.3">
            <p id="section-boilerplate.3-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-as-request-json" class="xref">AS Request JSON</a><a href="#section-boilerplate.3-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.3.2.1">
                <p id="section-boilerplate.3-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-top-level-attributes" class="xref">Top Level Attributes</a><a href="#section-boilerplate.3-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.3.2.2">
                <p id="section-boilerplate.3-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-client-object" class="xref">"client" Object</a><a href="#section-boilerplate.3-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.3.2.3">
                <p id="section-boilerplate.3-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-user-object" class="xref">"user" Object</a><a href="#section-boilerplate.3-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.3.2.4">
                <p id="section-boilerplate.3-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-authentication-object" class="xref">"authentication" Object</a><a href="#section-boilerplate.3-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.3.2.5">
                <p id="section-boilerplate.3-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-authorizations-object" class="xref">"authorizations" Object</a><a href="#section-boilerplate.3-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.3.2.6">
                <p id="section-boilerplate.3-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-claims-object" class="xref">"claims" Object</a><a href="#section-boilerplate.3-1.3.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.3.2.7">
                <p id="section-boilerplate.3-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-authorization-types" class="xref">Authorization Types</a><a href="#section-boilerplate.3-1.3.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.4">
            <p id="section-boilerplate.3-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-interaction-response-json" class="xref">Interaction Response JSON</a><a href="#section-boilerplate.3-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.4.2.1">
                <p id="section-boilerplate.3-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-user-object-2" class="xref">"user" Object</a><a href="#section-boilerplate.3-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.4.2.2">
                <p id="section-boilerplate.3-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-interaction-object" class="xref">"interaction" Object</a><a href="#section-boilerplate.3-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.4.2.3">
                <p id="section-boilerplate.3-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-authorization-object" class="xref">"authorization" Object</a><a href="#section-boilerplate.3-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.4.2.4">
                <p id="section-boilerplate.3-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-authentication-object-2" class="xref">"authentication" Object</a><a href="#section-boilerplate.3-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.5">
            <p id="section-boilerplate.3-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-interaction-types" class="xref">Interaction Types</a><a href="#section-boilerplate.3-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.5.2.1">
                <p id="section-boilerplate.3-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-popup-type" class="xref">"popup" Type</a><a href="#section-boilerplate.3-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.5.2.2">
                <p id="section-boilerplate.3-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-redirect-type" class="xref">"redirect" Type</a><a href="#section-boilerplate.3-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.5.2.3">
                <p id="section-boilerplate.3-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-qrcode-type" class="xref">"qrcode" Type</a><a href="#section-boilerplate.3-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.6">
            <p id="section-boilerplate.3-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-as-response-json" class="xref">AS Response JSON</a><a href="#section-boilerplate.3-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.1">
                <p id="section-boilerplate.3-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-top-level-attributes-2" class="xref">Top Level Attributes</a><a href="#section-boilerplate.3-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.2">
                <p id="section-boilerplate.3-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-authorizations-object-2" class="xref">"authorizations" Object</a><a href="#section-boilerplate.3-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.3">
                <p id="section-boilerplate.3-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-claims-object-2" class="xref">"claims" Object</a><a href="#section-boilerplate.3-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.4">
                <p id="section-boilerplate.3-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-access-methods" class="xref">Access Methods</a><a href="#section-boilerplate.3-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.7">
            <p id="section-boilerplate.3-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-discovery" class="xref">Discovery</a><a href="#section-boilerplate.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.8">
            <p id="section-boilerplate.3-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-jose-client-authentication" class="xref">JOSE Client Authentication</a><a href="#section-boilerplate.3-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.1">
                <p id="section-boilerplate.3-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-jose-headers" class="xref">JOSE Headers</a><a href="#section-boilerplate.3-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.2">
                <p id="section-boilerplate.3-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-authentication-request-toke" class="xref">Authentication Request Token</a><a href="#section-boilerplate.3-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.3">
                <p id="section-boilerplate.3-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-authorization-request-token" class="xref">Authorization Request Token</a><a href="#section-boilerplate.3-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.4">
                <p id="section-boilerplate.3-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-refresh-token" class="xref">Refresh Token</a><a href="#section-boilerplate.3-1.8.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.5">
                <p id="section-boilerplate.3-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-jose-access-token" class="xref">JOSE Access Token</a><a href="#section-boilerplate.3-1.8.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.6">
                <p id="section-boilerplate.3-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-http-authorization-jose-hea" class="xref">HTTP Authorization JOSE Header</a><a href="#section-boilerplate.3-1.8.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.7">
                <p id="section-boilerplate.3-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-jose-token-verification" class="xref">JOSE Token Verification</a><a href="#section-boilerplate.3-1.8.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.8">
                <p id="section-boilerplate.3-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-as-request" class="xref">AS Request</a><a href="#section-boilerplate.3-1.8.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.9">
                <p id="section-boilerplate.3-1.8.2.9.1"><a href="#section-8.9" class="xref">8.9</a>.  <a href="#name-interaction-response" class="xref">Interaction Response</a><a href="#section-boilerplate.3-1.8.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.10">
                <p id="section-boilerplate.3-1.8.2.10.1"><a href="#section-8.10" class="xref">8.10</a>.  <a href="#name-deletion-request" class="xref">Deletion Request</a><a href="#section-boilerplate.3-1.8.2.10.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.11">
                <p id="section-boilerplate.3-1.8.2.11.1"><a href="#section-8.11" class="xref">8.11</a>.  <a href="#name-authentication-request" class="xref">Authentication Request</a><a href="#section-boilerplate.3-1.8.2.11.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.12">
                <p id="section-boilerplate.3-1.8.2.12.1"><a href="#section-8.12" class="xref">8.12</a>.  <a href="#name-authentication-response" class="xref">Authentication Response</a><a href="#section-boilerplate.3-1.8.2.12.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.13">
                <p id="section-boilerplate.3-1.8.2.13.1"><a href="#section-8.13" class="xref">8.13</a>.  <a href="#name-authorization-request" class="xref">Authorization Request</a><a href="#section-boilerplate.3-1.8.2.13.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.14">
                <p id="section-boilerplate.3-1.8.2.14.1"><a href="#section-8.14" class="xref">8.14</a>.  <a href="#name-as-response" class="xref">AS Response</a><a href="#section-boilerplate.3-1.8.2.14.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.15">
                <p id="section-boilerplate.3-1.8.2.15.1"><a href="#section-8.15" class="xref">8.15</a>.  <a href="#name-bearer-token-rs-access" class="xref">Bearer Token RS Access</a><a href="#section-boilerplate.3-1.8.2.15.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.16">
                <p id="section-boilerplate.3-1.8.2.16.1"><a href="#section-8.16" class="xref">8.16</a>.  <a href="#name-proof-of-possession-rs-acce" class="xref">Proof-of-possession RS Access</a><a href="#section-boilerplate.3-1.8.2.16.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.17">
                <p id="section-boilerplate.3-1.8.2.17.1"><a href="#section-8.17" class="xref">8.17</a>.  <a href="#name-jose-body-rs-access" class="xref">JOSE Body RS Access</a><a href="#section-boilerplate.3-1.8.2.17.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.8.2.18">
                <p id="section-boilerplate.3-1.8.2.18.1"><a href="#section-8.18" class="xref">8.18</a>.  <a href="#name-access-refresh" class="xref">Access Refresh</a><a href="#section-boilerplate.3-1.8.2.18.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.9">
            <p id="section-boilerplate.3-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-error-messages" class="xref">Error Messages</a><a href="#section-boilerplate.3-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.10">
            <p id="section-boilerplate.3-1.10.1"><a href="#section-10" class="xref">10</a>.  <a href="#name-as-initiated-sequence" class="xref">AS Initiated Sequence</a><a href="#section-boilerplate.3-1.10.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.10.2.1">
                <p id="section-boilerplate.3-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-initiation-token" class="xref">Initiation Token</a><a href="#section-boilerplate.3-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.11">
            <p id="section-boilerplate.3-1.11.1"><a href="#section-11" class="xref">11</a>.  <a href="#name-extensibility" class="xref">Extensibility</a><a href="#section-boilerplate.3-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.12">
            <p id="section-boilerplate.3-1.12.1"><a href="#section-12" class="xref">12</a>.  <a href="#name-rational" class="xref">Rational</a><a href="#section-boilerplate.3-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.13">
            <p id="section-boilerplate.3-1.13.1"><a href="#section-13" class="xref">13</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-boilerplate.3-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.14">
            <p id="section-boilerplate.3-1.14.1"><a href="#section-14" class="xref">14</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-boilerplate.3-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.15">
            <p id="section-boilerplate.3-1.15.1"><a href="#section-15" class="xref">15</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-boilerplate.3-1.15.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.16">
            <p id="section-boilerplate.3-1.16.1"><a href="#section-16" class="xref">16</a>.  <a href="#name-references" class="xref">References</a><a href="#section-boilerplate.3-1.16.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.16.2.1">
                <p id="section-boilerplate.3-1.16.2.1.1"><a href="#section-16.1" class="xref">16.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-boilerplate.3-1.16.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.16.2.2">
                <p id="section-boilerplate.3-1.16.2.2.1"><a href="#section-16.2" class="xref">16.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-boilerplate.3-1.16.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.17">
            <p id="section-boilerplate.3-1.17.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-document-history" class="xref">Document History</a><a href="#section-boilerplate.3-1.17.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.17.2.1">
                <p id="section-boilerplate.3-1.17.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-draft-hardt-xauth-protocol-" class="xref">draft-hardt-xauth-protocol-00</a><a href="#section-boilerplate.3-1.17.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.17.2.2">
                <p id="section-boilerplate.3-1.17.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-draft-hardt-xauth-protocol-0" class="xref">draft-hardt-xauth-protocol-01</a><a href="#section-boilerplate.3-1.17.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.18">
            <p id="section-boilerplate.3-1.18.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-comparison-with-oauth-20-an" class="xref">Comparison with OAuth 2.0 and OpenID Connect</a><a href="#section-boilerplate.3-1.18.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.19">
            <p id="section-boilerplate.3-1.19.1"><a href="#section-appendix.c" class="xref"></a>  <a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-boilerplate.3-1.19.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This protocol supports the widely deployed use cases supported by OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>] &amp; </span><span>[<a href="#RFC6750" class="xref">RFC6750</a>], and OpenID Connect </span><span>[<a href="#OIDC" class="xref">OIDC</a>], an extension of OAuth 2.0, as well as other extensions, and other use cases that are not supported, such as requesting multiple authorizations in one request. This protocol also addresses many of the security issues in OAuth 2.0 by having parameters securely sent directly between parties, rather than via a browser redirection.</span><a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The technology landscape has changed since OAuth 2.0 was initially drafted. More interactions happen on mobile devices than PCs. Modern browsers now directly support asymetric cryptographic functions. Standards have emerged for signing and encrypting tokens with rich payloads (JOSE) that are widely deployed.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Additional use cases are now being served with extensions to OAuth 2.0: OpenID Connect added support for authentication and releasing identity claims; <span>[<a href="#RFC8252" class="xref">RFC8252</a>] added support for native apps; </span><span>[<a href="#RFC8628" class="xref">RFC8628</a>] added support for smart devices; and support for </span><span>[<a href="#browser_based_apps" class="xref">browser_based_apps</a>] is being worked on. There are numerous efforts on adding proof-of-possession to resource access.</span><a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This protocol simplifies the overall architectural model, takes advantage of today's technology landscape, provides support for all the widely deployed use cases, and offers numerous extension points.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">While this protocol is not backwards compatible with OAuth 2.0, it strives to minimize the migration effort.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-2">
      <h2 id="name-protocol">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol" class="section-name selfRef">Protocol</a>
      </h2>
<div id="parties">
<section id="section-2.1">
        <h3 id="name-parties">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-parties" class="section-name selfRef">Parties</a>
        </h3>
<ul>
<li id="section-2.1-1.1">
            <strong>Authorization Server</strong> (AS) - manages Client authorization to API resources and release of identity claims about the User. The AS may require explicit consent from the RO or User to provide these to the Client.<a href="#section-2.1-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-1.2">
            <strong>Client</strong> - requests authorization to API resources, and/or identity claims about the User. There are two types of Clients: Registered Clients and Dynamic Clients. An AS may support only one or both types. All Clients have a key to authenticate with the AS.<a href="#section-2.1-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-1.3">
            <strong>Registered Client</strong> - a Client that has registered with the AS and has a Client ID to identify itself, and can prove it possesses a key that is linked to the Client ID. The AS may have different policies for what different Registered Clients can request. The Client MAY be interacting  with a User.<a href="#section-2.1-1.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-1.4">
            <strong>Dynamic Client</strong> - a Client that has not been registered with the AS, and each instance will generate it's own key pair so it can prove it is the same instance of the Client on subsequent requests. A single-page application with no server is an example of a Dynamic Client. The Client MUST be interacting with a User.<a href="#section-2.1-1.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-1.5">
            <strong>User</strong> - the person who has delegated making identity claims about themselves to the AS, and is interacting with the Client.<a href="#section-2.1-1.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-1.6">
            <strong>Resource Server</strong> (RS) - has API resources that require an access token from the AS for access.<a href="#section-2.1-1.6" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-1.7">
            <strong>Resource Owner</strong> (RO) - owns the RS, and has delegated RS access token creation to the AS. The RO may be the same entity as the User, or may be a different entity that the AS interacts with independent of the Client.<a href="#section-2.1-1.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="handles">
<section id="section-2.2">
        <h3 id="name-handles">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-handles" class="section-name selfRef">Handles</a>
        </h3>
<p id="section-2.2-1">Handles are strings issued by the AS to the Client that are opaque to the Client.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.2-2.1">
            <strong>authorization handle</strong> - represents the client request. Presented back to the AS in an Authorization Request.<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.2">
            <strong>authentication handle</strong> - represents the client request for authentication first. Presented back to the AS in an Authentication Request, or in the subsequent AS Request.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.3">
            <strong>access handle</strong> - represents the access the AS has granted the Client to the RS. The Client proves possession of its key when presenting an access handle to access an RS. The RS is able to understand the authorizations represented by the access handle directly, or through an introspection call. The RS is able to verify the access handle was issued to the Client that presented it.<a href="#section-2.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.4">
            <strong>refresh handle</strong> - represents the access the AS has granted the Client to a RS. Presented back to the AS when the Client wants a fresh access token or access handle.<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-3">When presenting any of the above handles, the Client always proves possession of its key.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reused-terms">
<section id="section-2.3">
        <h3 id="name-reused-terms">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-reused-terms" class="section-name selfRef">Reused Terms</a>
        </h3>
<ul>
<li id="section-2.3-1.1">
            <strong>access token</strong> - an access token as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>] Section 1.4.</span><a href="#section-2.3-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-1.2">
            <strong>Claims</strong> - Claims as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>] Section 5.</span><a href="#section-2.3-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-1.3">
            <strong>Client ID</strong> - an AS unique identifier for a Registered Client as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>] Section 2.2.</span><a href="#section-2.3-1.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-1.4">
            <strong>ID Token</strong> - an ID Token as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>] Section 2.</span><a href="#section-2.3-1.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.3-1.5">
            <strong>NumericDate</strong> - a NumericDate as defined in <span>[<a href="#RFC7519" class="xref">RFC7519</a>] Section 2.</span><a href="#section-2.3-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="Sequence">
<section id="section-2.4">
        <h3 id="name-sequence">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-sequence" class="section-name selfRef">Sequence</a>
        </h3>
<ol type="1" start="1" class="normal" id="section-2.4-1">
          <li id="section-2.4-1.1">
            <strong>AS Discovery</strong> (<a href="#Discovery" class="xref">Section 7</a>) The Client discovers the AS end point, keys, supported claims and authorizations, and other capabilities.  Some, or all of this information could be manually preconfigured, or dynamically obtained. Dynamic AS discovery is out of scope of this document.<a href="#section-2.4-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.2">
            <strong>AS Request</strong> (<a href="#ASRequest" class="xref">Section 8.8</a>) The Client creates an AS Request (<a href="#ASRequestJSON" class="xref">Section 3</a>) for authorization to API resources and/or identity claims about the User and sends it with an HTTP POST to the AS endpoint. The Client includes requests authentication first if the Client wants the AS to authenticate the User prior to requesting additional claims and authorizations.<a href="#section-2.4-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.3">
            <strong>AS Request Evaluation</strong>   The AS processes the request and determines if it needs to interact with the RO or User. If interaction is required, the AS returns an Interaction Response (<a href="#InteractionResponseJSON" class="xref">Section 4</a>), if no interaction is required it returns an AS Response (<a href="#ASResponseJSON" class="xref">Section 6</a>).<a href="#section-2.4-1.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.4">
            <strong>Interaction Response</strong>  (<a href="#InteractionResponse" class="xref">Section 8.9</a>) The AS will send an authentication object unless the Client sent authentication first, in which case the AS will send an authentication object. If the AS wants the Client to initiate the User interaction, it will include an interaction object. If authentication first, the Client will next send (6) Authentication Request, otherwise an Authorization Request.<a href="#section-2.4-1.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.5">
            <strong>Authorization Request</strong> (<a href="#AuthorizationRequest" class="xref">Section 8.13</a>) The Client creates an authorization request token <a href="#AuthorizationRequestToken" class="xref">Section 8.3</a> and does a GET of the authorization uri, after waiting for any authorization wait time. The Client then listens for (13) AS Response.<a href="#section-2.4-1.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.6">
            <strong>Authentication Request</strong> (<a href="#AuthenticationRequest" class="xref">Section 8.11</a>) The Client creates an authentication request token and does a GET of the authentication uri. The Client then listens for (9) Authentication Response.<a href="#section-2.4-1.6" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.7">
            <strong>Interaction</strong> If the AS sent interaction instructions to the Client, the Client executes them.<a href="#section-2.4-1.7" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.8">
            <strong>User Authentication</strong> The AS authenticates the User. If Client requested authentication first, the AS responds to the Authentication Request with an (9) Authentication Response, otherwise the AS performs any needed authorizations per step (10).<a href="#section-2.4-1.8" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.9">
            <strong>Authentication Response</strong> (<a href="#AuthenticationResponse" class="xref">Section 8.12</a>) The AS sends an AS Response containing the identity claims the Client requested.<a href="#section-2.4-1.9" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.10">
            <strong>AS Request 2</strong>  The Client uses the returned identity claims to look up the User in its internal database and determines what, if any, claims and/or authorizations it would like to request and includes them in a new AS Request, as well as the authentication handle. If Client wants not additional claims and/or authorizations, the Client sets the claims object to the JSON null value. The Client then listens for (13) AS Response.<a href="#section-2.4-1.10" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.11">
            <strong>Authorization</strong> If required, the AS interacts with the User and/or RO to determine which of any of the authorizations and identity claims requests made by the Client are to be granted.<a href="#section-2.4-1.11" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.12">
            <strong>Redirect</strong> If the Client did a full browser redirect to the AS, the AS redirects the User back to the redirect_uri supplied by the Client, otherwise the AS closes its popup window, or informs the User the interaction is complete.<a href="#section-2.4-1.12" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.13">
            <strong>AS Response</strong> (<a href="#ASResponse" class="xref">Section 8.14</a>) The AS responds to the Client with a AS Response (<a href="#ASResponseJSON" class="xref">Section 6</a>) containing authorized RS access tokens and User identity claims. The AS may provide refresh handles and uris for each access token if they are authorized. If proof-of-possession is required for accessing the RS, the AS will provide access handles instead of access tokens. If the AS has not completed the interaction, it will instead return a retry response for the Client to make a new Authorization Request.<a href="#section-2.4-1.13" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.14">
            <strong>Resource Request</strong> (<a href="#Bearer" class="xref">Section 8.15</a>, <a href="#POP" class="xref">Section 8.16</a>, &amp; <a href="#POPbody" class="xref">Section 8.17</a>) The Client access the RS using a bearer token, a proof-of-possession token, or a signed request.<a href="#section-2.4-1.14" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-1.15">
            <strong>Access Refresh</strong> (<a href="#Refresh" class="xref">Section 8.18</a>) If the Client received a refresh handle and uri, it sends the refresh handle to the refresh uri, and receives a fresh access token or handle.<a href="#section-2.4-1.15" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.4-2"><strong>Sequence Diagram</strong><a href="#section-2.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.4-3">
<pre>
+--------+                                           +---------------+
|        |&lt;-(1)------- Discovery -------------------&gt;| Authorization |
|        |                                           |    Server     |
|        |--(2)------- AS Request ------------------&gt;|               |
|        |                                           | (3) Request   |
|        |                                           |    Evaluation |
|        |&lt;-(4)------- Interaction Response ---------|               |
|        |                                           |               |
|        |--(5)------- Authorization Request -------&gt;| -------+      |
|        |               or                          |        |      |
|        |--(6)------- Authentication Request ------&gt;| ---+   |      |
|        |                                           |    |   |      |
|        |               +--------+                  |    |   |      |
|        |--(7)---------&gt;|  User  |&lt;------------(8)--|    |   |      |
|        |  Interaction  +--------+  Authentication  |    |   |      |
| Client |                                           |    |   |      |
|        |                                           |    |   |      |
|        |&lt;-(9)------- Authentication Response ------|&lt;---+   |      |
|        |                                           |        |      |
|        |--(10)------ AS Request 2 ----------------&gt;| -------+      |
|        |                                           |        |      |
|        |               +--------+                  |        |      |
|        |&lt;-(12)---------|  User  |&lt;-----------(11)--|        |      |
|        |  Redirect     |  / RO  |   Authorization  |        |      |
|        |               +--------+                  |        |      |
|        |                                           |        |      |
|        |&lt;-(13)------ AS Response ------------------|&lt;-------+      |
|        |                                           |               |
|        |                             +----------+  |               |
|        |--(14)-- Resource Request --&gt;| Resource |  |               |
|        |&lt;------ Resource Response ---|  Server  |  |               |
|        |                             +----------+  |               |
|        |                                           |               |
|        |--(15)------- Refresh Request ------------&gt;|               |
|        |&lt;----------- Refresh Response -------------|               |
+--------+                                           +---------------+
</pre>
<a href="#section-2.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ASRequestJSON">
<section id="section-3">
      <h2 id="name-as-request-json">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-as-request-json" class="section-name selfRef">AS Request JSON</a>
      </h2>
<p id="section-3-1">Following is a non-normative JSON <span>[<a href="#RFC8259" class="xref">RFC8259</a>] document example where the Client wants to interact with the User with a popup and is requesting identity claims about the User and read access to the User's contacts:</span><a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-2">
<pre>
Example 1

{ 
    "as"    :"https://as.example",
    "iat"   :"1579046092",
    "nonce" :"f6a60810-3d07-41ac-81e7-b958c0dd21e4",
    "client": {
        "display": {
            "name"  :"SPA Display Name",
            "uri"   :"https://spa.example/about"
        },
        "interaction": {
            "type"  :"popup"
        }
    },
    "authorizations": {
        "type"      :"oauth_scope",
        "scope"     :"read_contacts"
    },
    "claims": {
        "oidc": {
            "id_token" : {
                "email"          : { "essential" : true },
                "email_verified" : { "essential" : true }
            },
            "userinfo" : {
                "name"           : { "essential" : true },
                "picture"        : null
            }
        }
    }
}
</pre>
<a href="#section-3-2" class="pilcrow">¶</a>
</div>
<p id="section-3-3">Following is a non-normative example where the Client has previously authenticated the User, and is requesting additional authorization:<a href="#section-3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-4">
<pre>
Example 2

{ 
    "as"    :"https://as.example",
    "iat"   :"1579046092",
    "nonce" :"0d1998d8-fbfa-4879-b942-85a88bff1f3b",
    "client": {
        "id"        : "di3872h34dkJW",
        "interaction": {
            "type"  : "redirect",
            "uri"   : "https://web.example/return"
        }
    },
    "user": {
        "identifiers": {
            "oidc": {
                "iss"   :"https://as.example",
                "sub"   :"123456789"
            }
        }
    },
    "authorizations": {
        "type"  :"oauth_scope",
        "scope" :"read_calendar write_calendar"
    }
}
</pre>
<a href="#section-3-4" class="pilcrow">¶</a>
</div>
<p id="section-3-5">Following is a non-normative example where the Client is requesting authorization first:<a href="#section-3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-6">
<pre>
Example 3

{ 
    "as"    :"https://as.example",
    "iat"   :"1579046092",
    "nonce" :"5c9360a5-9065-4f7b-a330-5713909e06c6",
    "client": {
        "id"        : "di3872h34dkJW",
        "interaction": {
            "type"  : "redirect",
            "uri"   : "https://web.example/return"
        }
    },
    "authentication": {
        "first": true
    },
    "claims": { "oidc": { "id_token" : {} } }
}
</pre>
<a href="#section-3-6" class="pilcrow">¶</a>
</div>
<p id="section-3-7">Following is a non-normative example where the Client previously requested authorization first (Example 3), the response was a new User, and now makes the following AS Request:<a href="#section-3-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3-8">
<pre>
Example 4

{ 
    "as"    :"https://as.example",
    "iat"   :"1579046092",
    "nonce" :"0a74f51f-514a-4821-b71f-01c252223f2f",
    "authentication": {
        "handle": "eyJhb958.example.authentication.handle.9yf3szM"
    },
    "claims": {
        "oidc": {
            "userinfo" : {
                "email"          : { "essential" : true },
                "phone_number"   : { "essential" : true },
                "name"           : { "essential" : true },
                "picture"        : null
            }
        }
    }
}
</pre>
<a href="#section-3-8" class="pilcrow">¶</a>
</div>
<div id="top-level-attributes">
<section id="section-3.1">
        <h3 id="name-top-level-attributes">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-top-level-attributes" class="section-name selfRef">Top Level Attributes</a>
        </h3>
<p id="section-3.1-1"><strong>as</strong> - the unique string identifier for the AS. This attribute is REQUIRED.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2"><strong>iat</strong> - the time of the request as a NumericDate.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3"><strong>nonce</strong> - a unique identifier for this request. This attribute is REQUIRED. Note the AS Response MUST contain a matching nonce attribute.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-object">
<section id="section-3.2">
        <h3 id="name-client-object">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-object" class="section-name selfRef">"client" Object</a>
        </h3>
<p id="section-3.2-1">The client object MUST contain either the client_id attribute for Registered Clients, or the display object for Dynamic Clients. If the Client can interact with the User, then an interaction object MUST be included. If there is an authentication handle, then the client object MUST not be included.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2"><strong>client_id</strong> - the identifier the AS has for the Registered Client.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3"><strong>display</strong> - the display object contains the following attributes:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-4.1">
            <strong>name</strong> - a string that represents the Dynamic Client<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-5">[Editor: a max length for the name?]<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-6.1">
            <strong>uri</strong> - a URI representing the Dynamic Client<a href="#section-3.2-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-7">[Editor: a max length for the URI?]<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">The name and uri will be displayed by the AS when prompting for authorization.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9"><strong>interaction</strong> - the interaction object contains the type of interaction the Client will provide the User. Other attributes are dependent on the interaction type value.<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-10.1">
            <strong>type</strong> - contains one of the following values: "popup", "redirect", or "qrcode". Details in <a href="#InteractionType" class="xref">Section 5</a>.<a href="#section-3.2-10.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-10.2">
            <strong>redirect_uri</strong> - this attribute is included if the type is "redirect". It is the URI that the Client requests the AS to redirect the User to after the AS has completed interacting with the User. If the Client manages session state in URIs, then the redirect_uri should contain that state.<a href="#section-3.2-10.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-10.3">
            <strong>ui_locales</strong> - End-User's preferred languages and scripts for the user interface, represented as a space-separated list of <span>[<a href="#RFC5646" class="xref">RFC5646</a>] language tag values, ordered by preference.</span><a href="#section-3.2-10.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-11">[Editor: do we need max pixels or max chars for qrcode interaction? Either passed to AS, or max specified values here?]<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<p id="section-3.2-12">[Editor: other possible interaction models could be a "webview", where the Client can display a web page, or just a "message", where the client can only display a text message]<a href="#section-3.2-12" class="pilcrow">¶</a></p>
<p id="section-3.2-13">[Editor: we may need to include interaction types for iOS and Android as the mobile OS APIs evolve.]<a href="#section-3.2-13" class="pilcrow">¶</a></p>
<p id="section-3.2-14">[Editor: does the Client include parameters if it wants the AS Response signed and/or encrypted?]<a href="#section-3.2-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-object">
<section id="section-3.3">
        <h3 id="name-user-object">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-user-object" class="section-name selfRef">"user" Object</a>
        </h3>
<p id="section-3.3-1">The user object is optional.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2"><strong>identifiers</strong> - the identifiers object contains one or more of the following identifiers for the User:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.3-3.1">
            <strong>phone_number</strong> - contains a phone number per Section 5 of <span>[<a href="#RFC3966" class="xref">RFC3966</a>].</span><a href="#section-3.3-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.2">
            <strong>email</strong> - contains an email address per <span>[<a href="#RFC5322" class="xref">RFC5322</a>].</span><a href="#section-3.3-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.3">
            <strong>oidc</strong> - is an object containing both the "iss" and "sub" attributes from an OpenID Connect ID Token per <span>[<a href="#OIDC" class="xref">OIDC</a>] Section 2.</span><a href="#section-3.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.3-4">The user and identifiers objects MAY be included to improve the user experience by the AS. The AS MUST authenticate the User independent of these values. The user object MUST not be included if there is an authentication handle.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5"><strong>discovery</strong> - MUST contain the JSON true value. Indicates the Client requests the AS to return a "discovered" attribute in the Interaction Response if the AS has a User at the AS with one or more of the identifiers. This attribute is OPTIONAL. Support of the discovery attribute by the AS is OPTIONAL. The AS MAY return the [TBD] error if discovery is not supported, or ignore the request.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-object">
<section id="section-3.4">
        <h3 id="name-authentication-object">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-authentication-object" class="section-name selfRef">"authentication" Object</a>
        </h3>
<p id="section-3.4-1">This OPTIONAL object MUST contain one of the following attributes:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4-2.1">
            <strong>first</strong> - Must have the JSON value true. Indicates the Client is requesting authentication first, and an authentication object in the Interaction Response. If present, the AS will ignore the authorizations object. [Editor: any use case where the Client needs an authorization at Authentication?] The Client SHOULD limit the claims requested to only those needed to identify the User at the Client. [Editor: this works if it is only a directed identifier, but consent would be required to return a verified phone or email. Hmmm.]<a href="#section-3.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.4-2.2">
            <strong>handle</strong> - the authentication handle. MUST be included in the AS Request following an Authentication Response.<a href="#section-3.4-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="authorizations-object">
<section id="section-3.5">
        <h3 id="name-authorizations-object">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-authorizations-object" class="section-name selfRef">"authorizations" Object</a>
        </h3>
<p id="section-3.5-1">The optional authorizations object contains a dictionary of resource objects the Client is requesting authorization to access. The authorizations object may contain one or more of:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.5-2.1">
            <strong>type</strong> - one of the following values: "oauth_scope", "oauth_rich", or "oauth_rich_list". See <a href="#AuthorizationTypes" class="xref">Section 3.7</a> for details.<a href="#section-3.5-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.5-2.2">
            <strong>scope</strong> - a string containing the OAuth 2.0 scope per <span>[<a href="#RFC6749" class="xref">RFC6749</a>] section 3.3. Present if type is "oauth_scope" or "oauth_rich".</span><a href="#section-3.5-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.5-2.3">
            <strong>authorization_details</strong> - an authorization_details object per <span>[<a href="#RAR" class="xref">RAR</a>]. Present if type is "oauth_rich".</span><a href="#section-3.5-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.5-2.4">
            <strong>list</strong> - an array of objects containing "scope" and "authorization_details". Present if type is "oauth_rich_list". Used when requesting multiple access tokens and/or handles.<a href="#section-3.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.5-3">[Editor: details may change as the <span>[<a href="#RAR" class="xref">RAR</a>] document evolves]</span><a href="#section-3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claims-object">
<section id="section-3.6">
        <h3 id="name-claims-object">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-claims-object" class="section-name selfRef">"claims" Object</a>
        </h3>
<p id="section-3.6-1">The optional claims object contains one or more identity claims being requested. The claims may contain:<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.6-2.1">
            <p id="section-3.6-2.1.1"><strong>oidc</strong> - an object that contains one or both of the following objects:  <a href="#section-3.6-2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.6-2.1.2.1">
                <strong>userinfo</strong> - Claims that will be returned as a JSON object<a href="#section-3.6-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-3.6-2.1.2.2">
                <strong>id_token</strong> - Claims that will be included in the returned ID Token. If the null value, an ID Token will be returned containing no additional Claims.<a href="#section-3.6-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.6-3">The contents of the userinfo and id_token objects are Claims as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>] Section 5.</span><a href="#section-3.6-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.6-4.1">
            <strong>oidc4ia</strong> - OpenID Connect for Identity Assurance claims request per <span>[<a href="#OIDC4IA" class="xref">OIDC4IA</a>].</span><a href="#section-3.6-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.6-4.2">
            <strong>vc</strong> - [Editor: define how W3C Verifiable Credentials <span>[<a href="#W3C_VC" class="xref">W3C_VC</a>] can be requested.]</span><a href="#section-3.6-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="AuthorizationTypes">
<section id="section-3.7">
        <h3 id="name-authorization-types">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-authorization-types" class="section-name selfRef">Authorization Types</a>
        </h3>
<ul>
<li id="section-3.7-1.1">
            <strong>oauth_scope</strong> - an OAuth 2.0 authorization request per <span>[<a href="#RFC6749" class="xref">RFC6749</a>] section 3.3</span><a href="#section-3.7-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.7-1.2">
            <strong>oauth_rich</strong> - a rich authorization request per <span>[<a href="#RAR" class="xref">RAR</a>]</span><a href="#section-3.7-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.7-1.3">
            <strong>oauth_rich_list</strong> - a list of rich authorization requests<a href="#section-3.7-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="InteractionResponseJSON">
<section id="section-4">
      <h2 id="name-interaction-response-json">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-interaction-response-json" class="section-name selfRef">Interaction Response JSON</a>
      </h2>
<p id="section-4-1">A non-normative example of an Interaction Response follows:<a href="#section-4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-2">
<pre>
{
    "user": {
        "discovered": true
    },
    "interaction": {
        "type"   : "popup",
        "uri"    : "https://as.example/endpoint/ey5gs32..."
    },
    "authorization": {
        "handle" : "eyJhb958.example.authorization.handle.9yf3szM",
        "uri"    : "https://as.example/authorization/ey7snHGs",
        "wait"   : "10"
    }
}
</pre>
<a href="#section-4-2" class="pilcrow">¶</a>
</div>
<div id="userObject">
<section id="section-4.1">
        <h3 id="name-user-object-2">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-user-object-2" class="section-name selfRef">"user" Object</a>
        </h3>
<p id="section-4.1-1">MUST contain one of "authorization" object, or "authentication" object.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-2.1">
            <strong>discovery</strong> - if the AS Request included a discovery attribute, then the AS MAY return a "user" object with the "discovered" property set to the JSON value true if one or more of the identifiers provided in the AS Request identify a User at the AS, or the JSON value false if not. If the Client received a false return, it may<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-3">[Editor: reference a security consideration for this functionality.]<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interactionObject">
<section id="section-4.2">
        <h3 id="name-interaction-object">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-interaction-object" class="section-name selfRef">"interaction" Object</a>
        </h3>
<p id="section-4.2-1">If the AS wants the Client to start the interaction, the AS MUST select one of the interaction mechanisms provided by the Client in the AS Request, and include the matching attribute in the interaction object:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.2-2.1">
            <strong>type</strong> - this MUST match the type provided by the Client in the AS Request client.interaction object.<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-2.2">
            <strong>uri</strong> - the URI to interact with the User per the type. This may be a temporary short URL if the type is qrcode so that it is easy to scan.<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-2.3">
            <strong>message</strong> - a text string to display to the User if type is qrcode.<a href="#section-4.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-3">[Editor: do we specify a maximum length for the uri and message so that a device knows the maximum it needs to support? A smart device may have limited screen real estate.]<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-object">
<section id="section-4.3">
        <h3 id="name-authorization-object">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-authorization-object" class="section-name selfRef">"authorization" Object</a>
        </h3>
<p id="section-4.3-1">The authorization object has the following attributes:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.3-2.1">
            <strong>handle</strong> - the authorization handle. This attribute is REQUIRED.<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.2">
            <strong>uri</strong> - the authorization URI. This attribute is REQUIRED.<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.3">
            <strong>wait</strong> - the amount of time in integer seconds the Client MUST wait before making the Authorization Request. This attribute is OPTIONAL.<a href="#section-4.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="authentication-object-1">
<section id="section-4.4">
        <h3 id="name-authentication-object-2">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-authentication-object-2" class="section-name selfRef">"authentication" Object</a>
        </h3>
<p id="section-4.4-1">Returned if the Client requested authentication first. The authentication object has the following attributes:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.4-2.1">
            <strong>handle</strong> - the authentication handle. This attribute is REQUIRED.<a href="#section-4.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-2.2">
            <strong>uri</strong> - the authentication URI. This attribute is REQUIRED.<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="InteractionType">
<section id="section-5">
      <h2 id="name-interaction-types">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-interaction-types" class="section-name selfRef">Interaction Types</a>
      </h2>
<p id="section-5-1">If the AS wants the Client to initiate the interaction with the User, then the AS will return an interaction object <a href="#interactionObject" class="xref">Section 4.2</a> so that the Client can can hand off interactions with the User to the AS. The Client will initiate the interaction with the User in one of the following ways:<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="popup-type">
<section id="section-5.1">
        <h3 id="name-popup-type">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-popup-type" class="section-name selfRef">"popup" Type</a>
        </h3>
<p id="section-5.1-1">The Client will create a new popup child browser window containing the value of the uri attribute of the interaction object. 
[Editor: more details on how to do this]<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The AS will close the window when the interactions with the User are complete. [Editor: confirm AS can do this still on all browsers, or does Client need to close]<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The AS MAY respond to an outstanding Authorization Request <a href="#AuthorizationRequest" class="xref">Section 8.13</a> before the popup window has been closed.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect-type">
<section id="section-5.2">
        <h3 id="name-redirect-type">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-redirect-type" class="section-name selfRef">"redirect" Type</a>
        </h3>
<p id="section-5.2-1">The Client will redirect the User to the value of the uri attribute of the interaction object. When the AS interactions with the User are complete, the AS will redirect the User to the redirect_uri the Client provided in the AS Request.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">If the Client made a Authorization Request when starting the interaction, the AS MAY respond to the Authorization Request <a href="#AuthorizationRequest" class="xref">Section 8.13</a> before the User has been redirected back to the Client.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="qrcode-type">
<section id="section-5.3">
        <h3 id="name-qrcode-type">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-qrcode-type" class="section-name selfRef">"qrcode" Type</a>
        </h3>
<p id="section-5.3-1">The Client will create a <span>[<a href="#QR_Code" class="xref">QR_Code</a>] of the uri attribute of the interaction object and display the resulting graphic and the message attribute of the interaction object as a text string.</span><a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ASResponseJSON">
<section id="section-6">
      <h2 id="name-as-response-json">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-as-response-json" class="section-name selfRef">AS Response JSON</a>
      </h2>
<p id="section-6-1">Example non-normative AS Response JSON document for Example 1 in <a href="#ASRequestJSON" class="xref">Section 3</a>:<a href="#section-6-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-2">
<pre>
{ 
    "iat":"15790460234",
    "nonce":"f6a60810-3d07-41ac-81e7-b958c0dd21e4",
    "authorizations": {
        "type"          : "oauth_scope",
        "scope"         : "read_contacts",
        "expires_in"    : "3600",
        "method"        : "bearer",
        "token"         : "eyJJ2D6.example.access.token.mZf9p"
    },
    "claims": {
        "oidc": {
            "id_token"      : "eyJhbUzI1N.example.id.token.YRw5DFdbW",
            "userinfo" : {
                "name"      : "John Doe",
                "picture"   : "https://photos.example/p/eyJzdkiO"
            }
        }
    }
}
</pre>
<a href="#section-6-2" class="pilcrow">¶</a>
</div>
<p id="section-6-3">Example non-normative AS Response JSON document for Example 2 in <a href="#ASRequestJSON" class="xref">Section 3</a>:<a href="#section-6-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-4">
<pre>
{
    "iat"   :"15790460234",
    "nonce" :"0d1998d8-fbfa-4879-b942-85a88bff1f3b",
    "authorizations": {
        "type"          : "oauth_scope",
        "scope"         : "read_calendar write_calendar",
        "expires_in"    : "3600",
        "method"        : "pop",
        "access": {
            "handle"    : "ey.example.access.handle.9yf3szM",
            "jwk": {
                "x5u"   : "https://as.example/jwk/VBUEOIQA82" 
            }       
        },
        "refresh": {
            "handle"    : "ey.example.refresh.handle.Jl4FzM",
            "uri"       : "https://as.example/refresh/eyj34"
        }
    }
}
</pre>
<a href="#section-6-4" class="pilcrow">¶</a>
</div>
<p id="section-6-5">Details of the JSON document:<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="top-level-attributes-1">
<section id="section-6.1">
        <h3 id="name-top-level-attributes-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-top-level-attributes-2" class="section-name selfRef">Top Level Attributes</a>
        </h3>
<p id="section-6.1-1"><strong>iat</strong> - the time of the response as a NumericDate.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2"><strong>nonce</strong> - the nonce that was included in the AS Request JSON <a href="#ASRequestJSON" class="xref">Section 3</a>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AuthorizationsObject">
<section id="section-6.2">
        <h3 id="name-authorizations-object-2">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-authorizations-object-2" class="section-name selfRef">"authorizations" Object</a>
        </h3>
<p id="section-6.2-1">There is an authorizations object in the AS Response if there was an authorizations object in the AS Request.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.2-2.1">
            <strong>type</strong> - the type of claim request: "oauth_scope", "oauth_rich", or "oauth_rich_list". See <a href="#AuthorizationTypes" class="xref">Section 3.7</a> for details.<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.2">
            <strong>list</strong> - an array of objects if the type was "oauth_rich_list". The objects have the following attributes just as if the type was "oauth_rich"<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.3">
            <strong>scope</strong> - the scopes the Client was granted authorization for. This will be all, or a subset, of what was requested.<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.4">
            <strong>authorization_details</strong> - the authorization details granted. Only returned for "oauth_rich" and "oauth_rich_list".<a href="#section-6.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.5">
            <strong>method</strong> - the access method: "bearer", "pop", or "jws". See <a href="#AccessMethod" class="xref">Section 6.4</a> for details.<a href="#section-6.2-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.6">
            <strong>token</strong> - an access token for accessing the resource(s). Included if the access method is "bearer".<a href="#section-6.2-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.7">
            <strong>expires_in</strong> - an optional value specifying how many seconds until the access token or handle expire.<a href="#section-6.2-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.8">
            <p id="section-6.2-2.8.1"><strong>refresh</strong> - an optional object containing parameters required to refresh an access token or handle. See refresh request <a href="#Refresh" class="xref">Section 8.18</a>.  <a href="#section-6.2-2.8.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.2-2.8.2.1">
                <strong>handle</strong> - an refresh handle used to create the JSON refresh token.<a href="#section-6.2-2.8.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-2.8.2.2">
                <strong>uri</strong> - the refresh uri the Client will use to refresh.<a href="#section-6.2-2.8.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-6.2-2.9">
            <p id="section-6.2-2.9.1"><strong>access</strong> - an object containing the parameters needed to access resources requiring proof-of-possession. Included if the access method is "pop".  <a href="#section-6.2-2.9.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.2-2.9.2.1">
                <strong>handle</strong> - the access handle.<a href="#section-6.2-2.9.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-2.9.2.2">
                <strong>jwk</strong> - the jwk object to use.<a href="#section-6.2-2.9.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="claims-object-1">
<section id="section-6.3">
        <h3 id="name-claims-object-2">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-claims-object-2" class="section-name selfRef">"claims" Object</a>
        </h3>
<p id="section-6.3-1">There is a claims object in the AS Response if there was a claims object in the AS Request.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.3-2.1">
            <p id="section-6.3-2.1.1"><strong>oidc</strong><a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.3-2.1.2.1">
                <strong>id_token</strong> - an OpenID Connect ID Token containing the Claims the User consented to be released.<a href="#section-6.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-6.3-2.1.2.2">
                <strong>userinfo</strong> - the Claims the User consented to be released.<a href="#section-6.3-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-6.3-2.1.3">
Claims are defined in <span>[<a href="#OIDC" class="xref">OIDC</a>] Section 5.</span><a href="#section-6.3-2.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.3-2.2">
            <strong>oidc4ia</strong> - OpenID Connect for Identity Assurance claims response per <span>[<a href="#OIDC4IA" class="xref">OIDC4IA</a>].</span><a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.3">
            <p id="section-6.3-2.3.1"><strong>vc</strong><a href="#section-6.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-6.3-2.3.2">
The verified claims the user consented to be released. [Editor: details TBD]<a href="#section-6.3-2.3.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="AccessMethod">
<section id="section-6.4">
        <h3 id="name-access-methods">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-access-methods" class="section-name selfRef">Access Methods</a>
        </h3>
<p id="section-6.4-1">The are three different methods for the Client to access an RS:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.4-2.1">
            <strong>bearer</strong> - the AS provides a bearer access token that the Client can use to access an RS per <a href="#Bearer" class="xref">Section 8.15</a>.<a href="#section-6.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.2">
            <strong>pop</strong> - the AS provides an access handle that the Client presents in a proof-of-possession RS access request per <a href="#POP" class="xref">Section 8.16</a>.<a href="#section-6.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.3">
            <strong>pop_body</strong> - the Client signs the JSON payload sent to the RS per <a href="#POPbody" class="xref">Section 8.17</a>.<a href="#section-6.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.4-3">In the AS Response, the AS will return the method the Client MUST use when accessing the RS.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Discovery">
<section id="section-7">
      <h2 id="name-discovery">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-discovery" class="section-name selfRef">Discovery</a>
      </h2>
<p id="section-7-1">The Client obtains the following metadata about the AS prior to initiating a request:<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2"><strong>Endpoint</strong> - the endpoint of the AS.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3"><strong>"as"</strong> - the unique string identifier for the AS.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4"><strong>Algorithms</strong> - the asymetric cryptographic algorithms supported by the AS.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5"><strong>Authorizations</strong> - the authorizations the Client may request, if any.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6"><strong>Identity Claims</strong> - the identity claims the Client may request, if any, and what public keys the claims will be signed with.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">The client may also obtain information about how the AS will sign and/or encrypt the AS Response, as well as any other metadata required for extensions to this protocol, as defined in those extension specifications.<a href="#section-7-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ClientAuthN">
<section id="section-8">
      <h2 id="name-jose-client-authentication">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-jose-client-authentication" class="section-name selfRef">JOSE Client Authentication</a>
      </h2>
<p id="section-8-1">The default mechanism for the Client to authenticate to the AS and the RS is signing a JSON document with JWS per <span>[<a href="#RFC7515" class="xref">RFC7515</a>]. The resulting tokens always use compact serialization.</span><a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">It is expected that extensions to this protocol that specify a different mechanism for the Client to authenticate, would over ride this section.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">The Authorization Request JSON is signed with JWS and passed as the body of the POST.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">The authorization, refresh, and access handles are signed with JWS resulting in authorization request, refresh, and access tokens respectively. These JOSE tokens are passed in the HTTP Authorization header with the "JOSE" parameter per <a href="#JOSEHTTP" class="xref">Section 8.6</a>.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">The Client will use the same private key to create all tokens.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">The Client and the AS MUST both use HTTP/2 (<span>[<a href="#RFC7540" class="xref">RFC7540</a>]) or later, and TLS 1.3 (</span><span>[<a href="#RFC8446" class="xref">RFC8446</a>]) or later, when communicating with each other.</span><a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">[Editor: too aggressive to mandate HTTP/2 and TLS 1.3?]<a href="#section-8-7" class="pilcrow">¶</a></p>
<div id="JOSEHeaders">
<section id="section-8.1">
        <h3 id="name-jose-headers">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-jose-headers" class="section-name selfRef">JOSE Headers</a>
        </h3>
<p id="section-8.1-1">A non-normative example of a JOSE header for a Registered Client using a key id to identify the Client's public key:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.1-2">
<pre>
{
    "alg":"ES256",
    "typ":"JOSE",
    "kid":"1"
}
</pre>
<a href="#section-8.1-2" class="pilcrow">¶</a>
</div>
<p id="section-8.1-3">A non-normative example of a JOSE header for a Registered Client using a certificate to assert the Client's public key:<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.1-4">
<pre>
{
    "alg":"ES256",
    "typ":"JOSE",
    "jwk":
        {"kty":"RSA",
        "use":"sig",
        "kid":"1b94c",
        "n":"vrjOfz9Ccdgx5nQudyhdoR17V-IubWMeOZCwX_jj0hgAsz2J_pqYW08
        PLbK_PdiVGKPrqzmDIsLI7sA25VEnHU1uCLNwBuUiCO11_-7dYbsr4iJmG0Q
        u2j8DsVyT1azpJC_NG84Ty5KKthuCaPod7iI7w0LK9orSMhBEwwZDCxTWq4a
        YWAchc8t-emd9qOvWtVMDC2BXksRngh6X5bUYLy6AyHKvj-nUy1wgzjYQDwH
        MTplCoLtU-o-8SNnZ1tmRoGE9uJkBLdh5gFENabWnU5m1ZqZPdwS-qo-meMv
        VfJb6jJVWRpl2SUtCnYG2C32qvbWbjZ_jBPD5eunqsIo1vQ",
        "e":"AQAB",
        "x5c":
        ["MIIDQjCCAiqgAwIBAgIGATz/FuLiMA0GCSqGSIb3DQEBBQUAMGIxCzAJB
        gNVBAYTAlVTMQswCQYDVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRwwGgYD
        VQQKExNQaW5nIElkZW50aXR5IENvcnAuMRcwFQYDVQQDEw5CcmlhbiBDYW1
        wYmVsbDAeFw0xMzAyMjEyMzI5MTVaFw0xODA4MTQyMjI5MTVaMGIxCzAJBg
        NVBAYTAlVTMQswCQYDVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRwwGgYDV
        QQKExNQaW5nIElkZW50aXR5IENvcnAuMRcwFQYDVQQDEw5CcmlhbiBDYW1w
        YmVsbDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAL64zn8/QnH
        YMeZ0LncoXaEde1fiLm1jHjmQsF/449IYALM9if6amFtPDy2yvz3YlRij66
        s5gyLCyO7ANuVRJx1NbgizcAblIgjtdf/u3WG7K+IiZhtELto/A7Fck9Ws6
        SQvzRvOE8uSirYbgmj6He4iO8NCyvaK0jIQRMMGQwsU1quGmFgHIXPLfnpn
        fajr1rVTAwtgV5LEZ4Iel+W1GC8ugMhyr4/p1MtcIM42EA8BzE6ZQqC7VPq
        PvEjZ2dbZkaBhPbiZAS3YeYBRDWm1p1OZtWamT3cEvqqPpnjL1XyW+oyVVk
        aZdklLQp2Btgt9qr21m42f4wTw+Xrp6rCKNb0CAwEAATANBgkqhkiG9w0BA
        QUFAAOCAQEAh8zGlfSlcI0o3rYDPBB07aXNswb4ECNIKG0CETTUxmXl9KUL
        +9gGlqCz5iWLOgWsnrcKcY0vXPG9J1r9AqBNTqNgHq2G03X09266X5CpOe1
        zFo+Owb1zxtp3PehFdfQJ610CDLEaS9V9Rqp17hCyybEpOGVwe8fnk+fbEL
        2Bo3UPGrpsHzUoaGpDftmWssZkhpBJKVMJyf/RuP2SmmaIzmnw9JiSlYhzo
        4tpzd5rFXhjRbg4zW9C+2qok+2+qDM1iJ684gPHMIY8aLWrdgQTxkumGmTq
        gawR+N5MDtdPTEQ0XfIBc2cJEUyMTY5MPvACWpkA6SdS4xSvdXK3IVfOWA=="]
        }    
}
</pre>
<a href="#section-8.1-4" class="pilcrow">¶</a>
</div>
<p id="section-8.1-5">[Editor: the jwk above was copy and pasted from the JWK example. Replace? ]<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<p id="section-8.1-6">The certificate could be signed by the AS, allowing the AS to verify the signature using the AS public key, or the certificate could be signed by a private key the AS has bound to the Registered Client, allowing each instance of the Registered Client to have its own asymetric key pair.<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<p id="section-8.1-7">A non-normative example of a JOSE header for a Dynamic Client including the public key generated by the Client that matches its its private key:<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.1-8">
<pre>
{
    "alg":"ES256",
    "typ":"JOSE",
    "jwk":{
        "kty":"EC",
        "crv":"P-256",
        "x":"Kgl5DJSgLyV-G32osmLhFKxJ97FoMW0dZVEqDG-Cwo4",
        "y":"GsL4mOM4x2e6iON8BHvRDQ6AgXAPnw0m0SfdlREV7i4"
    }
}
</pre>
<a href="#section-8.1-8" class="pilcrow">¶</a>
</div>
<p id="section-8.1-9">A non-normative example of a JOSE header for a JOSE access token for a Client accessing an RS that requires proof-of-possession:<a href="#section-8.1-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.1-10">
<pre>
{
    "alg":"ES256",
    "typ":"JOSE",
    "jwk":{
        "x5u":"https://as.example/jwk/VBUEOIQA82" 
    }
}
</pre>
<a href="#section-8.1-10" class="pilcrow">¶</a>
</div>
<p id="section-8.1-11">The "jwk" object in a JOSE access token <a href="#JOSEAccessToken" class="xref">Section 8.5</a> MUST be the AS jwk object the AS provided with the access handle.<a href="#section-8.1-11" class="pilcrow">¶</a></p>
<p id="section-8.1-12">This decouples how the AS communicates the Client's public key to the RS from how the AS asserts the Client's public key. The RS can have a consistent mechanism assert the Client's public key across all Clients.<a href="#section-8.1-12" class="pilcrow">¶</a></p>
<p id="section-8.1-13">One advantage of this is the AS can create a certificate of a Dynamic Client's public key, and pass it by value or reference to the Client to present to the RS.<a href="#section-8.1-13" class="pilcrow">¶</a></p>
<p id="section-8.1-14">All JOSE headers MUST have:
+ the "alg" attribute.
+ the "typ" attribute set to "jose".
+ either a "kid" or "jwk" attribute.<a href="#section-8.1-14" class="pilcrow">¶</a></p>
<p id="section-8.1-15">[Editor: should we use indicate the type of token (authorization, refresh, access) using "typ" or "cty"?]<a href="#section-8.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AuthenticationRequestToken">
<section id="section-8.2">
        <h3 id="name-authentication-request-toke">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-authentication-request-toke" class="section-name selfRef">Authentication Request Token</a>
        </h3>
<p id="section-8.2-1">A non-normative example of a payload follows:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.2-2">
<pre>
{
    "as"    :"https://as.example",
    "type"  :"authentication",
    "iat"   :"1579046092",
    "jti"   :"f6d72254-4f23-417f-b55e-14ad323b1dc1",
    "handle":"eyJhb958.example.authentication.handle.9yf3szM"
}
</pre>
<a href="#section-8.2-2" class="pilcrow">¶</a>
</div>
<p id="section-8.2-3">The payload of the authentication token contains:<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4"><strong>as</strong> - the unique string identifier for the AS.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5"><strong>type</strong> - the string "authentication", indicating the type of token.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6"><strong>iat</strong> - the time the authentication token was created as a NumericDate.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<p id="section-8.2-7"><strong>jti</strong> - a unique identifier for the authentication token per <span>[<a href="#RFC7519" class="xref">RFC7519</a>] section 4.1.7.</span><a href="#section-8.2-7" class="pilcrow">¶</a></p>
<p id="section-8.2-8"><strong>handle</strong> the authentication handle the AS provided the Client in the Interaction Response <a href="#InteractionResponseJSON" class="xref">Section 4</a>.<a href="#section-8.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AuthorizationRequestToken">
<section id="section-8.3">
        <h3 id="name-authorization-request-token">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-authorization-request-token" class="section-name selfRef">Authorization Request Token</a>
        </h3>
<p id="section-8.3-1">A non-normative example of a payload follows:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.3-2">
<pre>
{
    "as"    :"https://as.example",
    "type"  :"authorization",
    "iat"   :"1579046092",
    "jti"   :"f6d72254-4f23-417f-b55e-14ad323b1dc1",
    "handle":"eyJhb958.example.authorization.handle.9yf3szM"
}
</pre>
<a href="#section-8.3-2" class="pilcrow">¶</a>
</div>
<p id="section-8.3-3">The payload of the authorization token contains:<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4"><strong>as</strong> - the unique string identifier for the AS.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5"><strong>type</strong> - the string "authorization", indicating the type of token.<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<p id="section-8.3-6"><strong>iat</strong> - the time the authorization token was created as a NumericDate.<a href="#section-8.3-6" class="pilcrow">¶</a></p>
<p id="section-8.3-7"><strong>jti</strong> - a unique identifier for the authorization token per <span>[<a href="#RFC7519" class="xref">RFC7519</a>] section 4.1.7.</span><a href="#section-8.3-7" class="pilcrow">¶</a></p>
<p id="section-8.3-8"><strong>handle</strong> the authorization handle the AS provided the Client in the Interaction Response <a href="#InteractionResponseJSON" class="xref">Section 4</a>.<a href="#section-8.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RefreshRequestToken">
<section id="section-8.4">
        <h3 id="name-refresh-token">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-refresh-token" class="section-name selfRef">Refresh Token</a>
        </h3>
<p id="section-8.4-1">A non-normative example of a payload follows:<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.4-2">
<pre>
{
    "as"    :"https://as.example",
    "type"  :"refresh",
    "iat"   :"1579049876",
    "jti"   :"4342046d-83c4-4725-8c72-e9a49245f791",
    "handle":"eyJhb958.example.refresh.handle.9yf3szM"
}
</pre>
<a href="#section-8.4-2" class="pilcrow">¶</a>
</div>
<p id="section-8.4-3">The payload of the authorization token contains:<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4-4"><strong>as</strong> - the unique string identifier for the AS.<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<p id="section-8.4-5"><strong>type</strong> - the string "refresh", indicating the type of token.<a href="#section-8.4-5" class="pilcrow">¶</a></p>
<p id="section-8.4-6"><strong>iat</strong> - the time the refresh request token was created as a NumericDate.<a href="#section-8.4-6" class="pilcrow">¶</a></p>
<p id="section-8.4-7"><strong>jti</strong> - a unique identifier for the refresh request token.<a href="#section-8.4-7" class="pilcrow">¶</a></p>
<p id="section-8.4-8"><strong>handle</strong> the refresh handle the AS provided the Client in the AS Response <a href="#ASResponseJSON" class="xref">Section 6</a> or access refresh response <a href="#Refresh" class="xref">Section 8.18</a>.<a href="#section-8.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="JOSEAccessToken">
<section id="section-8.5">
        <h3 id="name-jose-access-token">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-jose-access-token" class="section-name selfRef">JOSE Access Token</a>
        </h3>
<p id="section-8.5-1">The "jwk" object in a JOSE access token header MUST be set to the "jwk" value the AS provided for the access handle.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">A non-normative example of a payload follows:<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.5-3">
<pre>
{
    "type"  :"access",
    "iat"   :"1579046092",
    "jti"   :"5ef47057-08f9-4763-be8d-162824d43dfb",
    "handle":"eyJhb958.example.access.handle.9yf3szM"
}
</pre>
<a href="#section-8.5-3" class="pilcrow">¶</a>
</div>
<p id="section-8.5-4">The payload of the JOSE access token contains:<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<p id="section-8.5-5"><strong>type</strong> - the string "access", indicating the type of token.<a href="#section-8.5-5" class="pilcrow">¶</a></p>
<p id="section-8.5-6"><strong>iat</strong> - the time the JOSE access token was created as a NumericDate.<a href="#section-8.5-6" class="pilcrow">¶</a></p>
<p id="section-8.5-7"><strong>jti</strong> - a unique identifier for the JOSE access token.<a href="#section-8.5-7" class="pilcrow">¶</a></p>
<p id="section-8.5-8"><strong>handle</strong> the access handle the AS provided the Client in the AS Response <a href="#ASResponseJSON" class="xref">Section 6</a> or access refresh response <a href="#Refresh" class="xref">Section 8.18</a>.<a href="#section-8.5-8" class="pilcrow">¶</a></p>
<p id="section-8.5-9">[Editor: should we include the called URI in the token?]<a href="#section-8.5-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="JOSEHTTP">
<section id="section-8.6">
        <h3 id="name-http-authorization-jose-hea">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-http-authorization-jose-hea" class="section-name selfRef">HTTP Authorization JOSE Header</a>
        </h3>
<p id="section-8.6-1">The Client authenticates requests by setting the HTTP Authorization header to include the "JOSE" parameter, followed by one or more space characters, followed by the appropriate JOSE token.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">A non-normative example:<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.6-3">
<pre>
Authorization: JOSE eyJhb.example.authorization.token.haDwskpFDBW
</pre>
<a href="#section-8.6-3" class="pilcrow">¶</a>
</div>
<p id="section-8.6-4">The authorization request token, refresh request token, and the JOSE access token are all passed in this manner.<a href="#section-8.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="jose-token-verification">
<section id="section-8.7">
        <h3 id="name-jose-token-verification">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-jose-token-verification" class="section-name selfRef">JOSE Token Verification</a>
        </h3>
<p id="section-8.7-1">TBD<a href="#section-8.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ASRequest">
<section id="section-8.8">
        <h3 id="name-as-request">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-as-request" class="section-name selfRef">AS Request</a>
        </h3>
<p id="section-8.8-1">The Client creates a JSON document per <a href="#ASRequestJSON" class="xref">Section 3</a>, signs it using JWS <span>[<a href="#RFC7515" class="xref">RFC7515</a>], and sends the JWS token to the AS end point using HTTP POST, with a content-type of application/jose.</span><a href="#section-8.8-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.8-2.1">
            <strong>Payload Encryption</strong><a href="#section-8.8-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.8-3">The AS may require the AS Request to be encrypted. If so, the JWS token is encrypted per JWE <span>[<a href="#RFC7516" class="xref">RFC7516</a>] using the public key and algorithm specified by the AS.</span><a href="#section-8.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="InteractionResponse">
<section id="section-8.9">
        <h3 id="name-interaction-response">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-interaction-response" class="section-name selfRef">Interaction Response</a>
        </h3>
<p id="section-8.9-1">If the Client set the authenticate_first flag, the response includes an authentication object, otherwise it includes an authorization object. If the AS wants the Client to initiate the User interaction, it sends an interaction object.<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<p id="section-8.9-2">If no interaction is required the AS will return an AS Response per <a href="#ASResponse" class="xref">Section 8.14</a>, otherwise the AS will return an Interaction Response per <a href="#InteractionResponseJSON" class="xref">Section 4</a>.<a href="#section-8.9-2" class="pilcrow">¶</a></p>
<p id="section-8.9-3">If the AS wants the Client to start the interaction, an interaction object will be returned in the response.<a href="#section-8.9-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.9-4.1">
            <strong>Error Responses</strong><a href="#section-8.9-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.9-5">The AS MAY respond with one of the following errors defined in <a href="#ErrorMessages" class="xref">Section 9</a>:<a href="#section-8.9-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.9-6">
<pre>
TBD
</pre>
<a href="#section-8.9-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="DeletionRequest">
<section id="section-8.10">
        <h3 id="name-deletion-request">
<a href="#section-8.10" class="section-number selfRef">8.10. </a><a href="#name-deletion-request" class="section-name selfRef">Deletion Request</a>
        </h3>
<p id="section-8.10-1">The Client MAY delete an outstanding request using the authorization token by making an HTTP DELETE call to the authorization uri, setting the HTTP Authorization header per <a href="#JOSEHTTP" class="xref">Section 8.6</a> with the authorization request token.<a href="#section-8.10-1" class="pilcrow">¶</a></p>
<p id="section-8.10-2">A non-normative deletion request example:<a href="#section-8.10-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.10-3">
<pre>
DELETE /authorization/ey7snHGs HTTP/2
Host: as.example
Authorization: JOSE eyJhb.example.authorization.token.haDwskpFDBW
</pre>
<a href="#section-8.10-3" class="pilcrow">¶</a>
</div>
<ul>
<li id="section-8.10-4.1">
            <strong>Error Responses</strong><a href="#section-8.10-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.10-5">The AS MAY respond with one of the following errors defined in <a href="#ErrorMessages" class="xref">Section 9</a>:<a href="#section-8.10-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.10-6">
<pre>
TBD
</pre>
<a href="#section-8.10-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="AuthenticationRequest">
<section id="section-8.11">
        <h3 id="name-authentication-request">
<a href="#section-8.11" class="section-number selfRef">8.11. </a><a href="#name-authentication-request" class="section-name selfRef">Authentication Request</a>
        </h3>
<p id="section-8.11-1"><a href="#AuthenticationRequestToken" class="xref">Section 8.2</a><a href="#section-8.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AuthenticationResponse">
<section id="section-8.12">
        <h3 id="name-authentication-response">
<a href="#section-8.12" class="section-number selfRef">8.12. </a><a href="#name-authentication-response" class="section-name selfRef">Authentication Response</a>
      </h3>
</section>
</div>
<div id="AuthorizationRequest">
<section id="section-8.13">
        <h3 id="name-authorization-request">
<a href="#section-8.13" class="section-number selfRef">8.13. </a><a href="#name-authorization-request" class="section-name selfRef">Authorization Request</a>
        </h3>
<p id="section-8.13-1">The Client makes an HTTP GET call to the authorization uri, setting the HTTP Authorization header per <a href="#JOSEHTTP" class="xref">Section 8.6</a> with the authorization request token.<a href="#section-8.13-1" class="pilcrow">¶</a></p>
<p id="section-8.13-2">A non-normative Authorization Request example:<a href="#section-8.13-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.13-3">
<pre>
GET /authorization/ey7snHGs HTTP/2
Host: as.example
Authorization: JOSE eyJhb.example.authorization.token.haDwskpFDBW
</pre>
<a href="#section-8.13-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ASResponse">
<section id="section-8.14">
        <h3 id="name-as-response">
<a href="#section-8.14" class="section-number selfRef">8.14. </a><a href="#name-as-response" class="section-name selfRef">AS Response</a>
        </h3>
<p id="section-8.14-1">The AS verifies the authorization request token, and then provides a response according to what the User and/or RO have authorized if required. If no signature or encryption was required, the AS will respond with a JSON document with content-type set to application/json.<a href="#section-8.14-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.14-2.1">
            <strong>Response Signing</strong><a href="#section-8.14-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.14-3">The AS MAY sign the response with a JWS per <span>[<a href="#RFC7515" class="xref">RFC7515</a>] and the private key matching the public key the AS defined as its AS Response signing key. The AS will respond with the content-type set to application/jose.</span><a href="#section-8.14-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.14-4.1">
            <strong>Response Encryption</strong><a href="#section-8.14-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.14-5">The AS MAY encrypt the response using the public key provided by the Client, using JWE per <span>[<a href="#RFC7516" class="xref">RFC7516</a>]. The AS will respond with the content-type set to application/jose.</span><a href="#section-8.14-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.14-6.1">
            <strong>Error Responses</strong><a href="#section-8.14-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.14-7">The AS MAY respond with one of the following errors defined in <a href="#ErrorMessages" class="xref">Section 9</a>:<a href="#section-8.14-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.14-8">
<pre>
TBD
</pre>
<a href="#section-8.14-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="Bearer">
<section id="section-8.15">
        <h3 id="name-bearer-token-rs-access">
<a href="#section-8.15" class="section-number selfRef">8.15. </a><a href="#name-bearer-token-rs-access" class="section-name selfRef">Bearer Token RS Access</a>
        </h3>
<p id="section-8.15-1">If the access method in the AS Response authorizations object <a href="#AuthorizationsObject" class="xref">Section 6.2</a> was "bearer", then the Client accesses the RS per Section 2.1 of <span>[<a href="#RFC6750" class="xref">RFC6750</a>]</span><a href="#section-8.15-1" class="pilcrow">¶</a></p>
<p id="section-8.15-2">A non-normative example of the HTTP request headers follows:<a href="#section-8.15-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.15-3">
<pre>
GET /calendar HTTP/2
Host: calendar.example
Authorization: bearer eyJJ2D6.example.access.token.mZf9pTSpA
</pre>
<a href="#section-8.15-3" class="pilcrow">¶</a>
</div>
<ul>
<li id="section-8.15-4.1">
            <strong>Error Responses</strong><a href="#section-8.15-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.15-5">TBD<a href="#section-8.15-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="POP">
<section id="section-8.16">
        <h3 id="name-proof-of-possession-rs-acce">
<a href="#section-8.16" class="section-number selfRef">8.16. </a><a href="#name-proof-of-possession-rs-acce" class="section-name selfRef">Proof-of-possession RS Access</a>
        </h3>
<p id="section-8.16-1">If the access method in the AS Response authorizations object <a href="#AuthorizationsObject" class="xref">Section 6.2</a> was "pop", then the Client creates a JOSE access token per <a href="#JOSEAccessToken" class="xref">Section 8.5</a> for each call to the RS, setting the HTTP Authorization header per <a href="#JOSEHTTP" class="xref">Section 8.6</a> with the JOSE access token.<a href="#section-8.16-1" class="pilcrow">¶</a></p>
<p id="section-8.16-2">A non-normative example of the HTTP request headers follows:<a href="#section-8.16-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.16-3">
<pre>
GET /calendar HTTP/2
Host: calendar.example
Authorization: JOSE eyJhbG.example.JOSE.access.token.kwwQb958
</pre>
<a href="#section-8.16-3" class="pilcrow">¶</a>
</div>
<ul>
<li id="section-8.16-4.1">
            <strong>Error Responses</strong><a href="#section-8.16-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.16-5">TBD<a href="#section-8.16-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="POPbody">
<section id="section-8.17">
        <h3 id="name-jose-body-rs-access">
<a href="#section-8.17" class="section-number selfRef">8.17. </a><a href="#name-jose-body-rs-access" class="section-name selfRef">JOSE Body RS Access</a>
        </h3>
<p id="section-8.17-1">If the access method in the AS Response authorizations object <a href="#AuthorizationsObject" class="xref">Section 6.2</a> was "pop_body", then the Client creates a JOSE access token per <a href="#JOSEAccessToken" class="xref">Section 8.5</a> for each call to the RS, setting the HTTP Authorization header per <a href="#JOSEHTTP" class="xref">Section 8.6</a> with the JOSE access token.<a href="#section-8.17-1" class="pilcrow">¶</a></p>
<p id="section-8.17-2">The Client creates a JSON document per the RS requirements. The document MUST include the access handle. The CLient then signs the document using JWS <span>[<a href="#RFC7515" class="xref">RFC7515</a>], and sends the resulting compact notation JWS token to the RS end point using HTTP POST, with a content-type of application/jose. Note this is similar to the AS Request </span><a href="#ASRequest" class="xref">Section 8.8</a>.<a href="#section-8.17-2" class="pilcrow">¶</a></p>
<p id="section-8.17-3">[Editor: any isues here? Anything missing that MUST be in the payload? Would an HTTP Authorization header make sense?]<a href="#section-8.17-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Refresh">
<section id="section-8.18">
        <h3 id="name-access-refresh">
<a href="#section-8.18" class="section-number selfRef">8.18. </a><a href="#name-access-refresh" class="section-name selfRef">Access Refresh</a>
        </h3>
<p id="section-8.18-1">If the Client received a refresh handle and uri from the AS in the Interaction Response, and it wants a fresh access token or handle, it creates a refresh request token per <a href="#RefreshRequestToken" class="xref">Section 8.4</a>.  setting the HTTP Authorization header per <a href="#JOSEHTTP" class="xref">Section 8.6</a> with the refresh request token. The AS will then respond with a refresh response.<a href="#section-8.18-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.18-2.1">
            <strong>Refresh Response</strong><a href="#section-8.18-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.18-3">A non-normative example refresh response with an access handle:<a href="#section-8.18-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.18-4">
<pre>
{
    "type"          : "oauth_scope",
    "scope"         : "read_calendar write_calendar",
    "expires_in"    : "3600",
    "method"        : "pop",
    "access": {
        "handle"    : "ey.example.access.handle.9yf3iWszM",
        "jwk": {
            "x5u"   : "https://as.example/jwk/VBUEOIQA82" 
        }       
    },
    "refresh": {
        "handle"    : "ey.example.refresh.handle.4SkjIi",
        "uri"       : "https://as.example/refresh/eyJl4FzM"
    }
}
</pre>
<a href="#section-8.18-4" class="pilcrow">¶</a>
</div>
<p id="section-8.18-5">The refresh response is the same as the authorizations object <a href="#AuthorizationsObject" class="xref">Section 6.2</a> in the AS Response.<a href="#section-8.18-5" class="pilcrow">¶</a></p>
<p id="section-8.18-6">If a new refresh handle and/or refresh uri is returned, the Client MUST use the new refresh handle and/or refresh uri<a href="#section-8.18-6" class="pilcrow">¶</a></p>
<p id="section-8.18-7">[Editor: are there other results relevant for <span>[<a href="#RAR" class="xref">RAR</a>]?]</span><a href="#section-8.18-7" class="pilcrow">¶</a></p>
<ul>
<li id="section-8.18-8.1">
            <strong>Error Responses</strong><a href="#section-8.18-8.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.18-9">The AS MAY respond with one of the following errors defined in <a href="#ErrorMessages" class="xref">Section 9</a>:<a href="#section-8.18-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.18-10">
<pre>
TBD
</pre>
<a href="#section-8.18-10" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ErrorMessages">
<section id="section-9">
      <h2 id="name-error-messages">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-error-messages" class="section-name selfRef">Error Messages</a>
      </h2>
<p id="section-9-1">[Editor: return "wait" time in AS Response when AS wants Client to wait before retying a Authorization Request.
The Client MUST generate a fresh authorization token when retrying the Authorization Request.
]<a href="#section-9-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-9-2">
<pre>
TBD
</pre>
<a href="#section-9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ASInitiatedSequence">
<section id="section-10">
      <h2 id="name-as-initiated-sequence">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-as-initiated-sequence" class="section-name selfRef">AS Initiated Sequence</a>
      </h2>
<p id="section-10-1">[Editor: AS initiated flows have been challenging to implement as OAuth 2.0 did not directly support them, so deployments bounced back and forth between the Client and AS to create a Client initiated flow. Here is a proposal to support AS initiated: authentication; just-in-time (JIT) provisioning; and authorization]<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">In this sequence the User starts at the AS, and then based on User input, the AS redirects the User to a Client, passing an initiation token <a href="#InitiationToken" class="xref">Section 10.1</a>, and then the Client retrieves authorizations and/or identity claims about the User. The Client MUST be a Registered Client. The sequence follows:<a href="#section-10-2" class="pilcrow">¶</a></p>
<ol type="1" start="1" class="normal" id="section-10-3">
        <li id="section-10-3.1">The User is interacting at the AS and wants to use the Client, and provide the Client identity claims and/or authorizations from the AS that the Client has pre-configured.<a href="#section-10-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-10-3.2">The AS creates a authorization handle and uri representing the identity claims and authorizations to be provided to the Client. The AS creates an initiation token containing the AS identifier, the authorization handle, and the authorization uri.<a href="#section-10-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-10-3.3">The AS redirects the User to a URI the Client has configured to accept initiation tokens, passing the initiation token as a query parameters with the name "token".<a href="#section-10-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-10-3.4">The Client verifies the initiation token.<a href="#section-10-3.4" class="pilcrow">¶</a>
</li>
        <li id="section-10-3.5">The Client makes an Authorization Request per <a href="#AuthorizationRequest" class="xref">Section 8.13</a>.<a href="#section-10-3.5" class="pilcrow">¶</a>
</li>
        <li id="section-10-3.6">The AS responds with an AS Response JSON document <a href="#ASResponseJSON" class="xref">Section 6</a> per <a href="#ASResponse" class="xref">Section 8.14</a>.<a href="#section-10-3.6" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-10-4">The Client now has the User identity claims and/or authorizations. If Client policy permits, the Client can perform JIT provisioning if the User is new to the Client.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5"><strong>AS Initiated Sequence Diagram</strong><a href="#section-10-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10-6">
<pre>
+--------+              +-------------+             +---------------+
|        |              |             |             |               |
|        |              |    User     |-------(1)--&gt;|               |
|        |              |             |             |               |
|        |              +-------------+             |  (2)          |
|        |                    /\                    |               |
| Client |&lt;--- initiation ---/  \-------------(3)---| Authorization |
|        |         token                            |    Server     |
|    (4) |                                          |               |
|        |                                          |               |
|        |--(5)------- Authorization Request ------&gt;|               |
|        |                                          |               |
|        |&lt;-(6)------- AS Response -----------------|               |
|        |                                          |               | 
+--------+                                          +---------------+
</pre>
<a href="#section-10-6" class="pilcrow">¶</a>
</div>
<div id="InitiationToken">
<section id="section-10.1">
        <h3 id="name-initiation-token">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-initiation-token" class="section-name selfRef">Initiation Token</a>
        </h3>
<p id="section-10.1-1">A non-normative example of an initiation token payload follows:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.1-2">
<pre>
{
    "as": "https://as.example",
    "authorization": {
        "handle" : "eyJhb958.example.authorization.handle.9yf3szM",
        "uri"    : "https://as.example/authorization/ey7snHGs"
    }
}
</pre>
<a href="#section-10.1-2" class="pilcrow">¶</a>
</div>
<ul>
<li id="section-10.1-3.1">
            <strong>as</strong> - the "as" identifier for the AS. This attribute is REQUIRED.<a href="#section-10.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-10.1-3.2">
            <p id="section-10.1-3.2.1"><strong>authorization</strong> - the authorization object has the following attributes:  <a href="#section-10.1-3.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-10.1-3.2.2.1">
                <strong>handle</strong> - the authorization handle. This attribute is REQUIRED.<a href="#section-10.1-3.2.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-10.1-3.2.2.2">
                <strong>uri</strong> - the authorization URI. This attribute is REQUIRED.<a href="#section-10.1-3.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-10.1-4">The initiation token is signed with JWS and uses the compact serialization.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extensibility">
<section id="section-11">
      <h2 id="name-extensibility">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-extensibility" class="section-name selfRef">Extensibility</a>
      </h2>
<p id="section-11-1">This standard can be extended in a number of areas:<a href="#section-11-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.1">
          <strong>Client Authentication Mechanisms</strong><a href="#section-11-2.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-3">An extension could define other mechanisms for the Client to authenticate and replace JOSE in <a href="#ClientAuthN" class="xref">Section 8</a> with Mutual TLS or HTTP Signing. Constrained environments could use CBOR <span>[<a href="#RFC7049" class="xref">RFC7049</a>] instead of JSON, and COSE </span><span>[<a href="#RFC8152" class="xref">RFC8152</a>] instead of JOSE, and CoAP </span><span>[<a href="#RFC8323" class="xref">RFC8323</a>] instead of HTTP/2.</span><a href="#section-11-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-4.1">
          <strong>AS Request</strong><a href="#section-11-4.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-5">An additional top level object could be added to the AS Request payload if the AS can manage delegations other than authorizations or claims, or some other functionality.<a href="#section-11-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-6.1">
          <strong>"client" Object</strong><a href="#section-11-6.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-7">Additional information about the Client that the AS would require related to an extension.<a href="#section-11-7" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-8.1">
          <strong>"user" Object</strong><a href="#section-11-8.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-9">Additional information about the Client that the AS would require related to an extension.<a href="#section-11-9" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-10.1">
          <strong>"authorizations" Object</strong><a href="#section-11-10.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-11">Additional types of authorizations in addition to OAuth 2.0 scopes and RAR.<a href="#section-11-11" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-12.1">
          <strong>"claims" Object</strong><a href="#section-11-12.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-13">Additional types of identity claims in addition to OpenID Connect claims and Verified Credentials.<a href="#section-11-13" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-14.1">
          <strong>Interaction</strong><a href="#section-11-14.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-15">Additional mechanisms for the Client to start an interaction with the User.<a href="#section-11-15" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-16.1">
          <strong>Access Methods</strong><a href="#section-11-16.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-17">Additional mechanisms for the Client to present authorization to a resource.<a href="#section-11-17" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-18.1">
          <strong>Continuous Authentication</strong><a href="#section-11-18.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-11-19">An extension could define a new handle for the Client to use to regularly provide continuous authentication signals and receive responses.<a href="#section-11-19" class="pilcrow">¶</a></p>
<p id="section-11-20">[Editor: do we specify access token / handle introspection in this document, or leave that to an extension?]<a href="#section-11-20" class="pilcrow">¶</a></p>
<p id="section-11-21">[Editor: do we specify access token / handle revocation in this document, or leave that to an extension?]<a href="#section-11-21" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rational">
<section id="section-12">
      <h2 id="name-rational">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-rational" class="section-name selfRef">Rational</a>
      </h2>
<ol type="1" start="1" class="normal" id="section-12-1">
        <li id="section-12-1.1">
          <p id="section-12-1.1.1"><strong>Why is there only one mechanism for the Client to authenticate with the AS? Why not support other mechanisms?</strong><a href="#section-12-1.1.1" class="pilcrow">¶</a></p>
<p id="section-12-1.1.2">
Having choices requires implementers to understand which choice is preferable for them. Having one default mechanism in the document for the Client to authenticate simplifies most implementations. Extensions can specify other mechanisms that are preferable in specific environments.<a href="#section-12-1.1.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.2">
          <p id="section-12-1.2.1"><strong>Why is the default Client authentication JOSE rather than MTLS?</strong><a href="#section-12-1.2.1" class="pilcrow">¶</a></p>
<p id="section-12-1.2.2">
MTLS cannot be used today by a Dynamic Client. MTLS requires the application to have access below what is typically the application layer, that is often not available on some platforms. JOSE is done at the application layer. Many AS deployments will be an application behind a proxy performing TLS, and there are risks in the proxy passing on the results of MTLS.<a href="#section-12-1.2.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.3">
          <p id="section-12-1.3.1"><strong>Why is the default Client authentication JOSE rather than HTTP signing?</strong><a href="#section-12-1.3.1" class="pilcrow">¶</a></p>
<p id="section-12-1.3.2">
There is currently no widely deployed open standard for HTTP signing. Additionally, HTTP signing requires passing all the relevant parts of the HTTP request to downstream services within an AS that may need to independently verify the Client identity.<a href="#section-12-1.3.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.4">
          <p id="section-12-1.4.1"><strong>What are the advantages of using JOSE for the Client to authenticate to the AS and a resource?</strong><a href="#section-12-1.4.1" class="pilcrow">¶</a></p>
<p id="section-12-1.4.2">
Both Registered Clients and Dynamic Clients can have a private key, eliminating the public Client issues in OAuth 2.0, as a Dynamic Client can create an ephemeral key pair. Using asymetric cryptography also allows each instance of a Registered Client to have its own private key if it can obtain a certificate binding its public key to the public key the AS has for the Client. Signed tokens can be passed to downstream components in a AS or RS to enable independent verification of the Client and its request. The AS Initiated Sequence <a href="#ASInitiatedSequence" class="xref">Section 10</a> requires a URL safe parameter, and JOSE is URL safe.<a href="#section-12-1.4.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.5">
          <p id="section-12-1.5.1"><strong>Why does the AS not return parameters to the Client in the redirect url?</strong><a href="#section-12-1.5.1" class="pilcrow">¶</a></p>
<p id="section-12-1.5.2">
Passing parameters via a browser redirection is the source of many of the security risks in OAuth 2.0. It also presents a challenge for smart devices. In this protocol, the redirection from the Client to the AS is to enable the AS to interact with the User, and the redirection back to the Client is to hand back interaction control to the Client if the redirection was a full browser redirect. Unlike OAuth 2.0, the identity of the Client is independent of the URI the AS redirects to.<a href="#section-12-1.5.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.6">
          <p id="section-12-1.6.1"><strong>Why is there not a UserInfo endpoint as there is with OpenID Connect?</strong><a href="#section-12-1.6.1" class="pilcrow">¶</a></p>
<p id="section-12-1.6.2">
In OpenID Connect, obtaining claims over the redirect or the Token Endpoint are problematic. The redirect is limited in size, and is not secure. The Token Endpoint is intended to return tokens, and is limited by the "application/x-www-form-urlencoded" format. A UserInfo endpoint returns "application/json", and can return rich claims, just as the authorization uri in this protocol.  <a href="#section-12-1.6.2" class="pilcrow">¶</a></p>
<p id="section-12-1.6.3">
[Editor: is there some other reason to have the UserInfo endpoint? What are industry best practices now? ]<a href="#section-12-1.6.3" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.7">
          <p id="section-12-1.7.1"><strong>Why is there still a Client ID? Could we not use a fingerprint of the public key to identify the Client?</strong><a href="#section-12-1.7.1" class="pilcrow">¶</a></p>
<p id="section-12-1.7.2">
Some AS deployments do not allow calls from Registered Clients, and provide different functionality to different Clients. A permanent identifier for the Client is needed for the Client developer and the AS admin to ensure they are referring to the same Client. The Client ID was used in OAuth 2.0, and it served the same purpose.<a href="#section-12-1.7.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.8">
          <p id="section-12-1.8.1"><strong>Why have both claims and authorizations?</strong><a href="#section-12-1.8.1" class="pilcrow">¶</a></p>
<p id="section-12-1.8.2">
There are use cases for each that are independent: authenticating a user vs granting access to a resource. A request for an authorization returns an access token or handle, while a request for a claim returns the claim.<a href="#section-12-1.8.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.9">
          <p id="section-12-1.9.1"><strong>Why specify HTTP/2 or later and TLS 1.3 or later for Client and AS communication in ?</strong><a href="#ClientAuthN" class="xref">Section 8</a><a href="#section-12-1.9.1" class="pilcrow">¶</a></p>
<p id="section-12-1.9.2">
Knowing the AS supports HTTP/2 enables a Client to set up a connection faster. HTTP/2 will be more efficient when Clients have large numbers of access tokens and are frequently refreshing them at the AS as there will be less network traffic. Mandating TLS 1.3 similarly improves the performance and security of Clients and AS when setting up a TLS connection.<a href="#section-12-1.9.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.10">
          <p id="section-12-1.10.1"><strong>Why do some of the JSON objects only have one child, such as the identifiers object in the user object in the AS Request?</strong><a href="#section-12-1.10.1" class="pilcrow">¶</a></p>
<p id="section-12-1.10.2">
It is difficult to forecast future use cases. Having more resolution may mean the difference between a simple extension, and a convoluted extension.<a href="#section-12-1.10.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.11">
          <p id="section-12-1.11.1"><strong>Why is the "iss" included in the "oidc" identifier object? Would the "sub" not be enough for the AS to identify the User?</strong><a href="#section-12-1.11.1" class="pilcrow">¶</a></p>
<p id="section-12-1.11.2">
The AS may use another AS to authenticate Users. The "iss" and "sub" combination is required to uniquely identify the User for any AS.<a href="#section-12-1.11.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.12">
          <p id="section-12-1.12.1"><strong>Why complicate the sequence with authentication first?</strong><a href="#section-12-1.12.1" class="pilcrow">¶</a></p>
<p id="section-12-1.12.2">
A common pattern is to use an AS to authenticate the User at the Client. The Client does not know a priori if the User is a new User, or a returning User. Asking a returning User to consent releasing identity claims and/or authorizations they have already provided is a poor User experience, as is sending the User back to the AS. The Client requesting identity first enables the Client to get a response from the AS while the AS is still interacting with the User, so that the Client can request any identity claims/or authorizations required or desired.<a href="#section-12-1.12.2" class="pilcrow">¶</a></p>
</li>
        <li id="section-12-1.13">
          <p id="section-12-1.13.1"><strong>Why is there a JOSE Body access  method for the Client?</strong><a href="#POPbody" class="xref">Section 8.17</a><a href="#section-12-1.13.1" class="pilcrow">¶</a></p>
<p id="section-12-1.13.2">
There are numerous use cases where the RS wants non-repudiation and providence of API calls. For example, the UAS Service Supplier Framework for Authentication and Authorization <span>[<a href="#UTM" class="xref">UTM</a>].</span><a href="#section-12-1.13.2" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="acknowledgments">
<section id="section-13">
      <h2 id="name-acknowledgments">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-13-1">This draft derives many of its concepts from Justin Richer's Transactional Authorization draft <span>[<a href="#TxAuth" class="xref">TxAuth</a>].</span><a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">Additional thanks to Justin Richer for his strong critique of earlier drafts.<a href="#section-13-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">[ JOSE parameter for Authorization HTTP header ]<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">TBD<a href="#section-14-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-15-1">TBD<a href="#section-15-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-16">
      <h2 id="name-references">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-16.1">
        <h3 id="name-normative-references">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="OIDC">[OIDC]</dt>
        <dd>
<span class="refAuthor">Sakimora, N.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Jones, M.</span><span class="refAuthor">, de Medeiros, B.</span><span class="refAuthor">, and C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2014-11">November 2014</time>
          <span>, &lt;<a href="https://openiD.net/specs/openiD-connect-core-1_0.html">https://openiD.net/specs/openiD-connect-core-1_0.html</a>&gt;</span>. </dd>
<dt id="OIDC4IA">[OIDC4IA]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor"> and D. Fett</span>, <span class="refTitle">"OpenID Connect for Identity Assurance 1.0"</span>, <time datetime="2019-10">October 2019</time>
          <span>, &lt;<a href="https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html">https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html</a>&gt;</span>. </dd>
<dt id="RFC3966">[RFC3966]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refTitle">"The tel URI for Telephone Numbers"</span>, <span class="seriesInfo">RFC 3966</span>, <span class="seriesInfo">DOI 10.17487/RFC3966</span>, <time datetime="2004-12">December 2004</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc3966">https://www.rfc-editor.org/info/rfc3966</a>&gt;</span>. </dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10">October 2008</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dt id="RFC5646">[RFC5646]</dt>
        <dd>
<span class="refAuthor">Phillips, A., Ed.</span><span class="refAuthor"> and M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09">September 2009</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc5646">https://www.rfc-editor.org/info/rfc5646</a>&gt;</span>. </dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10">October 2012</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10">October 2012</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05">May 2015</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dt id="RFC7516">[RFC7516]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05">May 2015</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc7516">https://www.rfc-editor.org/info/rfc7516</a>&gt;</span>. </dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05">May 2015</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dt id="RFC7540">[RFC7540]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span><span class="refAuthor">, Peon, R.</span><span class="refAuthor">, and M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05">May 2015</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12">December 2017</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08">August 2018</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-16.2">
        <h3 id="name-informative-references">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="browser_based_apps">[browser_based_apps]</dt>
        <dd>
<span class="refAuthor">Parecki, A.</span><span class="refAuthor"> and D. Waite</span>, <span class="refTitle">"OAuth 2.0 for Browser-Based Apps"</span>, <time datetime="2019-09">September 2019</time>
          <span>, &lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps-04">https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps-04</a>&gt;</span>. </dd>
<dt id="QR_Code">[QR_Code]</dt>
        <dd>
<span class="refAuthor"></span>, <span class="refTitle">"ISO/IEC 18004:2015 - Information technology - Automatic identification and data capture techniques - QR Code bar code symbology specification"</span>, <time datetime="2015-02">February 2015</time>
          <span>, &lt;<a href="https://www.iso.org/standard/62021.html">https://www.iso.org/standard/62021.html</a>&gt;</span>. </dd>
<dt id="RAR">[RAR]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor">, Richer, J.</span><span class="refAuthor">, and B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <time datetime="2020-01">January 2020</time>
          <span>, &lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-rar-00">https://tools.ietf.org/html/draft-ietf-oauth-rar-00</a>&gt;</span>. </dd>
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10">October 2013</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07">July 2017</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dt id="RFC8252">[RFC8252]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span><span class="refAuthor"> and J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10">October 2017</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc8252">https://www.rfc-editor.org/info/rfc8252</a>&gt;</span>. </dd>
<dt id="RFC8323">[RFC8323]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor">, Lemay, S.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Hartke, K.</span><span class="refAuthor">, Silverajan, B.</span><span class="refAuthor">, and B. Raymor, Ed.</span>, <span class="refTitle">"CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets"</span>, <span class="seriesInfo">RFC 8323</span>, <span class="seriesInfo">DOI 10.17487/RFC8323</span>, <time datetime="2018-02">February 2018</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc8323">https://www.rfc-editor.org/info/rfc8323</a>&gt;</span>. </dd>
<dt id="RFC8628">[RFC8628]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Jones, M.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08">August 2019</time>
            <span>, &lt;<a href="https://www.rfc-editor.org/info/rfc8628">https://www.rfc-editor.org/info/rfc8628</a>&gt;</span>. </dd>
<dt id="TxAuth">[TxAuth]</dt>
        <dd>
<span class="refAuthor">Richer, J.</span>, <span class="refTitle">"Transactional Authorization"</span>, <time datetime="2019-12">December 2019</time>
          <span>, &lt;<a href="https://tools.ietf.org/html/draft-richer-transactional-authz-04">https://tools.ietf.org/html/draft-richer-transactional-authz-04</a>&gt;</span>. </dd>
<dt id="UTM">[UTM]</dt>
        <dd>
<span class="refAuthor">Rios, J.</span><span class="refAuthor">, Smith, I.</span><span class="refAuthor">, and P. Venkatesen</span>, <span class="refTitle">"UAS Service Supplier Framework for Authentication and Authorization"</span>, <time datetime="2019-09">September 2019</time>
          <span>, &lt;<a href="https://utm.arc.nasa.gov/docs/2019-UTM_Framework-NASA-TM220364.pdf">https://utm.arc.nasa.gov/docs/2019-UTM_Framework-NASA-TM220364.pdf</a>&gt;</span>. </dd>
<dt id="W3C_VC">[W3C_VC]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span><span class="refAuthor">, Noble, G.</span><span class="refAuthor">, and D. Chadwick</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.0"</span>, <time datetime="2019-11">November 2019</time>
          <span>, &lt;<a href="https://w3c.github.io/vc-data-model/">https://w3c.github.io/vc-data-model/</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="document-history">
<section id="section-appendix.a">
      <h2 id="name-document-history">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<div id="draft-hardt-xauth-protocol-00">
<section id="section-a.1">
        <h2 id="name-draft-hardt-xauth-protocol-">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-draft-hardt-xauth-protocol-" class="section-name selfRef">draft-hardt-xauth-protocol-00</a>
        </h2>
<ul>
<li id="section-a.1-1.1">Initial version<a href="#section-a.1-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-01">
<section id="section-a.2">
        <h2 id="name-draft-hardt-xauth-protocol-0">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-draft-hardt-xauth-protocol-0" class="section-name selfRef">draft-hardt-xauth-protocol-01</a>
        </h2>
<ul>
<li id="section-a.2-1.1">text clean up<a href="#section-a.2-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.2">added OIDC4IA claims<a href="#section-a.2-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.3">added "jws" method for accessing a resource.<a href="#section-a.2-1.3" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.4">renamed Initiation Request -&gt; AS Request<a href="#section-a.2-1.4" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.5">renamed Initiation Response -&gt; Interaction Response<a href="#section-a.2-1.5" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.6">renamed Completion Request -&gt; Authorization Request<a href="#section-a.2-1.6" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.7">renamed Completion Response -&gt; AS Request<a href="#section-a.2-1.7" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.8">renamed completion handle -&gt; authorization handle<a href="#section-a.2-1.8" class="pilcrow">¶</a>
</li>
          <li id="section-a.2-1.9">added Authentication Request, Authentication Response, authentication handle<a href="#section-a.2-1.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="comparison-with-oauth-20-and-openid-connect">
<section id="section-appendix.b">
      <h2 id="name-comparison-with-oauth-20-an">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-comparison-with-oauth-20-an" class="section-name selfRef">Comparison with OAuth 2.0 and OpenID Connect</a>
      </h2>
<p id="section-appendix.b-1"><strong>Changed Features</strong><a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">The major differences between this protocol and OAuth 2.0 and OpenID Connect are:<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.b-3.1">The Client uses a private key to authenticate in this protocol instead of the client secret in OAuth 2.0 and OpenID Connect.<a href="#section-appendix.b-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.2">The Client initiates the protocol by making a signed request directly to the AS instead of redirecting the User to the AS.<a href="#section-appendix.b-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.3">The Client does not receive any parameters from a redirection of the User back from the AS.<a href="#section-appendix.b-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.4">Refreshing an access token requires creating a refresh token from a refresh handle, rather than an authenticated call with a refresh token.<a href="#section-appendix.b-3.4" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-3.5">The Client can request identity claims to be returned independent of the ID Token. There is no UserInfo endpoint to query claims as there is in OpenID Connect.<a href="#section-appendix.b-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-4"><strong>Preserved Features</strong><a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.b-5.1">This protocol reuses the OAuth 2.0 scopes, Client IDs, and access tokens of OAuth 2.0.<a href="#section-appendix.b-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-5.2">This protocol reuses the Client IDs, Claims and ID Token of OpenID Connect.<a href="#section-appendix.b-5.2" class="pilcrow">¶</a>
</li>
        <li id="section-appendix.b-5.3">No change is required by the Client or the RS for existing APIs.<a href="#section-appendix.b-5.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">SignIn.Org</span></div>
<div dir="auto" class="left">,  </div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@gmail.com" class="email">dick.hardt@gmail.com</a>
</div>
</address>
</section>
</div>
<script>@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 624px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  line-height: 17px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  font-style: italic;
  margin: 0.3em 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 600px) {
  #authors-addresses {
    display: relative;
    padding: 32px 0 0;
    column-count: 2;
    column-gap: 20px;
  }
  #name-authors-addresses {
    position: absolute;
    top: 0px;
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
  }
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #b76427;
  background-color: rgba(249, 232, 105, 0.3);
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: rgba(249, 232, 105, 0.3);
  border-radius: 3px;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 953px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 954px) {
  body {
    padding-right: 380px;
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</script>
</body>
</html>
